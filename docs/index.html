<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Management System</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f1f1f1;
            border: none;
            outline: none;
            transition: 0.3s;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab:hover {
            background-color: #ddd;
        }
        .tab.active {
            background-color: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 5px 5px;
        }
        .tab-content.active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #2980b9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .attendance-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            align-items: center;
        }
        .month-selector {
            display: flex;
            align-items: center;
        }
        .month-selector select, .month-selector button {
            margin-right: 10px;
        }
        .present {
            background-color: #2ecc71;
            color: white;
        }
        .absent {
            background-color: #e74c3c;
            color: white;
        }
        .attendance-btn {
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        .search-container {
            margin-bottom: 20px;
        }
        .search-container input {
            width: 300px;
            display: inline-block;
        }
        .action-btns button {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Student Management System</h1>
        
        <div class="tabs">
            <button class="tab active" onclick="openTab('add-student')">Add Student</button>
            <button class="tab" onclick="openTab('manage-students')">Manage Students</button>
            <button class="tab" onclick="openTab('attendance')">Attendance</button>
        </div>
        
        <div id="add-student" class="tab-content active">
            <h2>Add New Student</h2>
            <form id="student-form">
                <div class="form-group">
                    <label for="student-id">Student ID</label>
                    <input type="text" id="student-id" required>
                </div>
                <div class="form-group">
                    <label for="student-name">Full Name</label>
                    <input type="text" id="student-name" required>
                </div>
                <div class="form-group">
                    <label for="student-class">Class/Grade</label>
                    <input type="text" id="student-class" required>
                </div>
                <div class="form-group">
                    <label for="student-section">Section</label>
                    <input type="text" id="student-section" required>
                </div>
                <div class="form-group">
                    <label for="student-dob">Date of Birth</label>
                    <input type="date" id="student-dob" required>
                </div>
                <div class="form-group">
                    <label for="student-contact">Contact Number</label>
                    <input type="tel" id="student-contact">
                </div>
                <button type="submit">Add Student</button>
            </form>
        </div>
        
        <div id="manage-students" class="tab-content">
            <h2>Student Records</h2>
            <div class="search-container">
                <input type="text" id="search-student" placeholder="Search by name or ID..." oninput="searchStudents()">
            </div>
            <table id="students-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Class</th>
                        <th>Section</th>
                        <th>DOB</th>
                        <th>Contact</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="students-list">
                    <!-- Student records will be inserted here -->
                </tbody>
            </table>
        </div>
        
        <div id="attendance" class="tab-content">
            <h2>Monthly Attendance</h2>
            <div class="attendance-controls">
                <div class="month-selector">
                    <select id="attendance-month">
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                    <select id="attendance-year">
                        <!-- Years will be populated by JavaScript -->
                    </select>
                    <button onclick="loadAttendance()">Load Attendance</button>
                </div>
                <div>
                    <button onclick="markAllPresent()">Mark All Present</button>
                    <button onclick="markAllAbsent()">Mark All Absent</button>
                    <button onclick="saveAttendance()">Save Attendance</button>
                </div>
            </div>
            <table id="attendance-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Class</th>
                        <th>Section</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="attendance-list">
                    <!-- Attendance records will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Initialize the system when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load students from localStorage
            loadStudents();
            
            // Populate year dropdown for attendance
            populateYearDropdown();
            
            // Set current month and year
            const currentDate = new Date();
            document.getElementById('attendance-month').value = currentDate.getMonth() + 1;
            document.getElementById('attendance-year').value = currentDate.getFullYear();
            
            // Load current month's attendance
            loadAttendance();
            
            // Set up form submission
            document.getElementById('student-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addStudent();
            });
        });
        
        // Tab navigation
        function openTab(tabId) {
            // Hide all tab contents
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // Remove active class from all tabs
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // Show the selected tab content and mark tab as active
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
            
            // If opening attendance tab, refresh the view
            if (tabId === 'attendance') {
                loadAttendance();
            }
        }
        
        // Student data functions
        function loadStudents() {
            const students = JSON.parse(localStorage.getItem('students')) || [];
            const studentsList = document.getElementById('students-list');
            studentsList.innerHTML = '';
            
            students.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>${student.section}</td>
                    <td>${student.dob}</td>
                    <td>${student.contact}</td>
                    <td class="action-btns">
                        <button onclick="editStudent('${student.id}')">Edit</button>
                        <button onclick="deleteStudent('${student.id}')">Delete</button>
                    </td>
                `;
                studentsList.appendChild(row);
            });
        }
        
        function addStudent() {
            const id = document.getElementById('student-id').value;
            const name = document.getElementById('student-name').value;
            const studentClass = document.getElementById('student-class').value;
            const section = document.getElementById('student-section').value;
            const dob = document.getElementById('student-dob').value;
            const contact = document.getElementById('student-contact').value;
            
            // Get existing students or initialize empty array
            const students = JSON.parse(localStorage.getItem('students')) || [];
            
            // Check if student ID already exists
            if (students.some(student => student.id === id)) {
                alert('Student ID already exists!');
                return;
            }
            
            // Add new student
            students.push({
                id,
                name,
                class: studentClass,
                section,
                dob,
                contact
            });
            
            // Save to localStorage
            localStorage.setItem('students', JSON.stringify(students));
            
            // Reset form
            document.getElementById('student-form').reset();
            
            // Reload student list
            loadStudents();
            
            // Show success message
            alert('Student added successfully!');
            
            // Switch to manage students tab
            document.querySelector('.tab[onclick="openTab(\'manage-students\')"]').click();
        }
        
        function editStudent(id) {
            const students = JSON.parse(localStorage.getItem('students')) || [];
            const student = students.find(s => s.id === id);
            
            if (!student) {
                alert('Student not found!');
                return;
            }
            
            // Fill form with student data
            document.getElementById('student-id').value = student.id;
            document.getElementById('student-name').value = student.name;
            document.getElementById('student-class').value = student.class;
            document.getElementById('student-section').value = student.section;
            document.getElementById('student-dob').value = student.dob;
            document.getElementById('student-contact').value = student.contact;
            
            // Change button text
            document.querySelector('#student-form button').textContent = 'Update Student';
            
            // Remove old submit event and add update event
            const form = document.getElementById('student-form');
            form.removeEventListener('submit', addStudent);
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                updateStudent(id);
            });
            
            // Switch to add student tab
            document.querySelector('.tab[onclick="openTab(\'add-student\')"]').click();
        }
        
        function updateStudent(oldId) {
            const id = document.getElementById('student-id').value;
            const name = document.getElementById('student-name').value;
            const studentClass = document.getElementById('student-class').value;
            const section = document.getElementById('student-section').value;
            const dob = document.getElementById('student-dob').value;
            const contact = document.getElementById('student-contact').value;
            
            let students = JSON.parse(localStorage.getItem('students')) || [];
            
            // Check if new ID already exists (and it's not the same student)
            if (id !== oldId && students.some(student => student.id === id)) {
                alert('Student ID already exists!');
                return;
            }
            
            // Update student
            students = students.map(student => {
                if (student.id === oldId) {
                    return {
                        id,
                        name,
                        class: studentClass,
                        section,
                        dob,
                        contact
                    };
                }
                return student;
            });
            
            // Update attendance records if ID was changed
            if (oldId !== id) {
                updateAttendanceRecordsId(oldId, id);
            }
            
            // Save to localStorage
            localStorage.setItem('students', JSON.stringify(students));
            
            // Reset form
            document.getElementById('student-form').reset();
            
            // Change button text back
            document.querySelector('#student-form button').textContent = 'Add Student';
            
            // Reload student list
            loadStudents();
            
            // Show success message
            alert('Student updated successfully!');
            
            // Switch to manage students tab
            document.querySelector('.tab[onclick="openTab(\'manage-students\')"]').click();
            
            // Restore original event listener
            const form = document.getElementById('student-form');
            form.removeEventListener('submit', updateStudent);
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                addStudent();
            });
        }
        
        function deleteStudent(id) {
            if (!confirm('Are you sure you want to delete this student?')) {
                return;
            }
            
            let students = JSON.parse(localStorage.getItem('students')) || [];
            
            // Remove student
            students = students.filter(student => student.id !== id);
            
            // Remove student's attendance records
            removeAttendanceRecords(id);
            
            // Save to localStorage
            localStorage.setItem('students', JSON.stringify(students));
            
            // Reload student list
            loadStudents();
            
            // Show success message
            alert('Student deleted successfully!');
        }
        
        function searchStudents() {
            const searchTerm = document.getElementById('search-student').value.toLowerCase();
            const students = JSON.parse(localStorage.getItem('students')) || [];
            const filteredStudents = students.filter(student => 
                student.id.toLowerCase().includes(searchTerm) || 
                student.name.toLowerCase().includes(searchTerm)
            );
            
            const studentsList = document.getElementById('students-list');
            studentsList.innerHTML = '';
            
            filteredStudents.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>${student.section}</td>
                    <td>${student.dob}</td>
                    <td>${student.contact}</td>
                    <td class="action-btns">
                        <button onclick="editStudent('${student.id}')">Edit</button>
                        <button onclick="deleteStudent('${student.id}')">Delete</button>
                    </td>
                `;
                studentsList.appendChild(row);
            });
        }
        
        // Attendance functions
        function populateYearDropdown() {
            const yearSelect = document.getElementById('attendance-year');
            const currentYear = new Date().getFullYear();
            
            // Add 10 years before and after current year
            for (let year = currentYear - 10; year <= currentYear + 10; year++) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }
        }
        
        function loadAttendance() {
            const month = document.getElementById('attendance-month').value;
            const year = document.getElementById('attendance-year').value;
            const students = JSON.parse(localStorage.getItem('students')) || [];
            const attendanceKey = `attendance-${month}-${year}`;
            const attendanceData = JSON.parse(localStorage.getItem(attendanceKey)) || {};
            const attendanceList = document.getElementById('attendance-list');
            
            attendanceList.innerHTML = '';
            
            if (students.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="6" style="text-align: center;">No students found. Please add students first.</td>';
                attendanceList.appendChild(row);
                return;
            }
            
            students.forEach(student => {
                const studentAttendance = attendanceData[student.id] || 'absent';
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>${student.section}</td>
                    <td class="${studentAttendance}">${studentAttendance.toUpperCase()}</td>
                    <td>
                        <button class="attendance-btn ${studentAttendance === 'present' ? 'present' : 'absent'}" 
                                onclick="toggleAttendance('${student.id}')">
                            ${studentAttendance === 'present' ? 'Mark Absent' : 'Mark Present'}
                        </button>
                    </td>
                `;
                attendanceList.appendChild(row);
            });
        }
        
        function toggleAttendance(studentId) {
            const month = document.getElementById('attendance-month').value;
            const year = document.getElementById('attendance-year').value;
            const attendanceKey = `attendance-${month}-${year}`;
            const attendanceData = JSON.parse(localStorage.getItem(attendanceKey)) || {};
            
            // Toggle attendance status
            attendanceData[studentId] = attendanceData[studentId] === 'present' ? 'absent' : 'present';
            
            // Update localStorage
            localStorage.setItem(attendanceKey, JSON.stringify(attendanceData));
            
            // Reload attendance view
            loadAttendance();
        }
        
        function markAllPresent() {
            if (!confirm('Mark all students as present for this month?')) {
                return;
            }
            
            const month = document.getElementById('attendance-month').value;
            const year = document.getElementById('attendance-year').value;
            const students = JSON.parse(localStorage.getItem('students')) || [];
            const attendanceKey = `attendance-${month}-${year}`;
            const attendanceData = {};
            
            students.forEach(student => {
                attendanceData[student.id] = 'present';
            });
            
            localStorage.setItem(attendanceKey, JSON.stringify(attendanceData));
            loadAttendance();
        }
        
        function markAllAbsent() {
            if (!confirm('Mark all students as absent for this month?')) {
                return;
            }
            
            const month = document.getElementById('attendance-month').value;
            const year = document.getElementById('attendance-year').value;
            const students = JSON.parse(localStorage.getItem('students')) || [];
            const attendanceKey = `attendance-${month}-${year}`;
            const attendanceData = {};
            
            students.forEach(student => {
                attendanceData[student.id] = 'absent';
            });
            
            localStorage.setItem(attendanceKey, JSON.stringify(attendanceData));
            loadAttendance();
        }
        
        function saveAttendance() {
            alert('Attendance saved successfully!');
        }
        
        function updateAttendanceRecordsId(oldId, newId) {
            // Get all keys from localStorage
            const keys = Object.keys(localStorage);
            
            keys.forEach(key => {
                if (key.startsWith('attendance-')) {
                    const attendanceData = JSON.parse(localStorage.getItem(key));
                    if (attendanceData && attendanceData[oldId]) {
                        attendanceData[newId] = attendanceData[oldId];
                        delete attendanceData[oldId];
                        localStorage.setItem(key, JSON.stringify(attendanceData));
                    }
                }
            });
        }
        
        function removeAttendanceRecords(id) {
            // Get all keys from localStorage
            const keys = Object.keys(localStorage);
            
            keys.forEach(key => {
                if (key.startsWith('attendance-')) {
                    const attendanceData = JSON.parse(localStorage.getItem(key));
                    if (attendanceData && attendanceData[id]) {
                        delete attendanceData[id];
                        localStorage.setItem(key, JSON.stringify(attendanceData));
                    }
                }
            });
        }
    </script>
</body>
</html>
